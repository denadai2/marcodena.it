<!DOCTYPE html>
<html lang="en">
<head>
          <title>Detecting anomalies with Neural newtorks</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link href="//www.google-analytics.com" rel="dns-prefetch">
        <link href="http://www.marcodena.it/theme/images/favicon.png" rel="shortcut icon">
        <link rel='stylesheet' id='normalize-css'  href='http://www.marcodena.it/theme/css/normalize.css' media='all' />
        <link rel='stylesheet' id='foundation-css'  href='http://www.marcodena.it/theme/css/foundation.min.css' media='all' />
        <link rel='stylesheet' href='http://www.marcodena.it/theme/css/style.css' media='all' />
        <link rel='stylesheet' href='http://www.marcodena.it/theme/css/marcodenashare-embedded.css' media='all' />
        <link rel='stylesheet' href='http://www.marcodena.it/theme/css/monokai.css' media='all' />
        <script type='text/javascript' src='http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js'></script>





</head>

<body id="index" class="home">
    <div class="wrapper row">
            <div class="large-12 columns">
                <div class="row">
                    <div id="sidebar" class="large-4 columns">
                        <!-- header -->
                        <header class="header clear" role="banner">

                            <!-- logo -->
                            <div class="logo">
                                <a href="http://www.marcodena.it/" class="show-for-medium-up">
                                    <img src="http://www.marcodena.it/theme/images/marcodena.jpg" alt="Logo" class="logo-img">
                                </a><br />
                                <a href="http://www.marcodena.it/" class="logo-name">Marco De Nadai</a>
                            </div>
                            <!-- /logo -->

                            <!-- nav -->
                            <nav class="nav" role="navigation">
                                <ul>
                                    <li class="column small-4 medium-12"><a href="http://www.marcodena.it/">Home</a></li>
                                    <li class="column small-4 medium-12"><a href="http://www.marcodena.it/blog.html">Blog</a></li>
                                    <li class="column small-4 medium-12"><a href="http://www.marcodena.it/about">About</a></li>
                                </ul>

                            </nav>
                            <!-- /nav -->

                        </header>
                        <!-- /header -->

                        <!-- footer -->
                        <footer class="footer" role="contentinfo">

                            <div id="icons">
                                <a rel="me" title="Linkedin Account" href="http://nl.linkedin.com/in/marcodenadai/">
                                    <svg width="32" height="32" version="1.1" id="Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve">
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#256FBB" d="M48,42c0,3.313-2.687,6-6,6H6c-3.313,0-6-2.687-6-6V6
                                          c0-3.313,2.687-6,6-6h36c3.313,0,6,2.687,6,6V42z"></path>
                                    <g>
                                    <g>
                                    <path fill="#257EAA" d="M13.237,33.891h4.988V16.842h-4.988V33.891z M15.731,9.966c-1.608,0-2.658,1.083-2.625,2.527
                                          c-0.033,1.378,1.018,2.494,2.593,2.494c1.641,0,2.691-1.116,2.691-2.494C18.357,11.049,17.339,9.966,15.731,9.966z M31.712,17.081
                                          c-1.595,0-3.222-0.329-4.956,2.36h-0.099l-0.087-2.599h-4.417c0.065,1.411,0.074,3.518,0.074,5.52v11.529h4.988v-9.855
                                          c0-0.46,0.065-0.919,0.196-1.248c0.328-0.919,1.149-1.871,2.527-1.871c1.805,0,2.527,1.411,2.527,3.479v9.495h4.988V23.773
                                          C37.455,19.047,34.993,17.081,31.712,17.081z"></path>
                                    </g>
                                    </g>
                                    <g>
                                    <g>
                                    <path fill="#FFFFFF" d="M15.731,11.633c-1.608,0-2.658,1.083-2.625,2.527c-0.033,1.378,1.018,2.494,2.593,2.494
                                          c1.641,0,2.691-1.116,2.691-2.494C18.357,12.716,17.339,11.633,15.731,11.633z M13.237,35.557h4.988V18.508h-4.988V35.557z
                                          M31.712,18.748c-1.595,0-3.222-0.329-4.956,2.36h-0.099l-0.087-2.599h-4.417c0.065,1.411,0.074,3.518,0.074,5.52v11.529h4.988
                                          v-9.854c0-0.46,0.065-0.919,0.196-1.248c0.328-0.919,1.149-1.871,2.527-1.871c1.805,0,2.527,1.411,2.527,3.479v9.494h4.988V25.439
                                          C37.455,20.713,34.993,18.748,31.712,18.748z"></path>
                                    </g>
                                    </g>
                                    </svg>
                                </a>
                                <a rel="me" title="twitter account" href="http://twitter.com/denadai2">
                                    <svg version="1.1" width="32" height="32" id="Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve">
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#29AAE1" d="M48,42c0,3.313-2.687,6-6,6H6c-3.313,0-6-2.687-6-6V6
                                          c0-3.313,2.687-6,6-6h36c3.313,0,6,2.687,6,6V42z"></path>
                                    <path fill="#29AAE1" d="M40.231,13.413c-1.12,0.497-2.323,0.833-3.588,0.984c1.291-0.774,2.28-1.998,2.747-3.457
                                          c-1.206,0.716-2.543,1.236-3.968,1.516c-1.139-1.214-2.763-1.972-4.56-1.972c-3.449,0-6.246,2.796-6.246,6.247
                                          c0,0.49,0.055,0.966,0.161,1.424c-5.192-0.261-9.795-2.749-12.876-6.528c-0.538,0.923-0.846,1.996-0.846,3.141
                                          c0,2.167,1.103,4.08,2.779,5.199c-1.024-0.032-1.987-0.313-2.83-0.781c0,0.026,0,0.053,0,0.079c0,3.026,2.153,5.551,5.011,6.125
                                          c-0.525,0.143-1.076,0.219-1.646,0.219c-0.403,0-0.794-0.038-1.176-0.11c0.795,2.48,3.102,4.287,5.835,4.338
                                          c-2.138,1.675-4.832,2.675-7.758,2.675c-0.504,0-1.002-0.03-1.491-0.089c2.765,1.773,6.048,2.808,9.576,2.808
                                          c11.49,0,17.774-9.519,17.774-17.774c0-0.271-0.006-0.54-0.019-0.809C38.334,15.766,39.394,14.666,40.231,13.413z"></path>
                                    <path fill="#FFFFFF" d="M40.231,14.739c-1.12,0.497-2.323,0.833-3.588,0.984c1.291-0.773,2.28-1.998,2.747-3.456
                                          c-1.206,0.716-2.543,1.236-3.968,1.516c-1.139-1.214-2.763-1.972-4.56-1.972c-3.449,0-6.246,2.796-6.246,6.247
                                          c0,0.489,0.055,0.966,0.161,1.424c-5.192-0.261-9.795-2.748-12.876-6.527c-0.538,0.923-0.846,1.996-0.846,3.141
                                          c0,2.167,1.103,4.079,2.779,5.199c-1.024-0.032-1.987-0.313-2.83-0.781c0,0.026,0,0.052,0,0.079c0,3.027,2.153,5.551,5.011,6.125
                                          c-0.525,0.144-1.076,0.219-1.646,0.219c-0.403,0-0.794-0.038-1.176-0.11c0.795,2.481,3.102,4.287,5.835,4.338
                                          c-2.138,1.676-4.832,2.675-7.758,2.675c-0.504,0-1.002-0.03-1.491-0.089c2.765,1.773,6.048,2.808,9.576,2.808
                                          c11.49,0,17.774-9.519,17.774-17.774c0-0.271-0.006-0.54-0.019-0.808C38.334,17.092,39.394,15.992,40.231,14.739z"></path>
                                    </svg>
                                </a>
                                <a rel="me" title="Github account" href="https://github.com/denadai2">
                                    <svg version="1.1" width="32" height="32" id="Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve">
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#fff" d="M48,42c0,3.313-2.687,6-6,6H6c-3.313,0-6-2.687-6-6V6
                                          c0-3.313,2.687-6,6-6h36c3.313,0,6,2.687,6,6V42z"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="none" d="M27.695,29.811c0,0,1.519,5.062,5.974,4.05
                                          c4.456-1.013,4.759-6.684,2.127-9.619C33.163,21.305,26.379,25.962,27.695,29.811z"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M11.828,18.179c0,0-3.344,3.499-2.763,9.192
                                          c0.581,5.694,4.186,10.392,16.208,10.392c12.021,0,15.045-6.275,15.116-11.436c0.071-5.159-2.253-7.46-3.344-8.243
                                          c0,0,0.007-3.704-0.343-5.661c0,0-1.85-0.219-5.845,2.07c0,0-5.454-0.533-12.722,0.065c0,0-3.053-2.04-6.129-2.574
                                          C12.006,11.984,11.496,15.196,11.828,18.179z"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#E2B89F" d="M17.211,23.815h14.916c0,0,4.227-0.475,4.227,6.44
                                          c0.034,6.086-11.139,5.693-11.139,5.693s-12.236,0.486-12.243-6.269C12.956,23.579,17.211,23.815,17.211,23.815z"></path>
                                    <g>
                                    <g>
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#9C584F" d="M30.767,26.591c0.959,0,1.737,1.25,1.737,2.787
                                          c0,1.54-0.778,2.788-1.737,2.788c-0.958,0-1.736-1.248-1.736-2.788C29.03,27.841,29.809,26.591,30.767,26.591z"></path>
                                    <path fill="#FFFFFF" d="M30.767,32.666c-1.254,0-2.236-1.444-2.236-3.288c0-1.843,0.982-3.287,2.236-3.287
                                          c1.255,0,2.237,1.444,2.237,3.287C33.004,31.222,32.021,32.666,30.767,32.666z M30.767,27.091c-0.585,0-1.236,0.939-1.236,2.287
                                          c0,1.349,0.651,2.288,1.236,2.288s1.237-0.939,1.237-2.288C32.004,28.03,31.352,27.091,30.767,27.091z"></path>
                                    </g>
                                    </g>
                                    <g>
                                    <g>
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#9C584F" d="M18.767,26.591c0.959,0,1.737,1.25,1.737,2.787
                                          c0,1.54-0.778,2.788-1.737,2.788c-0.958,0-1.736-1.248-1.736-2.788C17.03,27.841,17.809,26.591,18.767,26.591z"></path>
                                    <path fill="#FFFFFF" d="M18.767,32.666c-1.254,0-2.236-1.444-2.236-3.288c0-1.843,0.982-3.287,2.236-3.287
                                          c1.254,0,2.237,1.444,2.237,3.287C21.004,31.222,20.021,32.666,18.767,32.666z M18.767,27.091c-0.585,0-1.236,0.939-1.236,2.287
                                          c0,1.349,0.651,2.288,1.236,2.288c0.585,0,1.237-0.939,1.237-2.288C20.004,28.03,19.352,27.091,18.767,27.091z"></path>
                                    </g>
                                    </g>
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#9C584F" d="M24.076,32.705c0,0,0.499-1.418,1.109-0.089
                                          c0,0-0.457,0.297-0.285,0.996l1.428,0.546h-3.23l1.28-0.575C24.378,33.583,24.562,32.527,24.076,32.705z"></path>
                                    </svg>
                                </a>
                                <a rel="me" title="Curriculum vitae" href="http://www.marcodena.it/CV.pdf">
                                    <svg version="1.1" id="Icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                         width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">
                                    <path fill="#C93D1D" d="M32,28c0,2.209-1.791,4-4,4H4c-2.208,0-4-1.791-4-4V4c0-2.208,1.792-4,4-4h24c2.209,0,4,1.792,4,4V28z"/>
                                    <path fill="#FCFCFC" d="M6.103,28.922L6.103,28.922c-0.342,0-0.67-0.111-0.95-0.32C4.13,27.834,3.993,26.98,4.059,26.4
                                          c0.178-1.6,2.154-3.271,5.875-4.977c1.477-3.234,2.881-7.222,3.719-10.553c-0.979-2.133-1.932-4.899-1.237-6.522
                                          c0.243-0.568,0.67-0.969,1.236-1.157c0.224-0.075,0.443-0.113,0.65-0.113c0.495,0,0.938,0.216,1.246,0.609
                                          c0.289,0.369,1.161,1.481-0.151,7.007c1.323,2.733,3.198,5.517,4.995,7.425c1.287-0.234,2.395-0.352,3.297-0.352
                                          c1.537,0,2.469,0.357,2.849,1.096c0.314,0.609,0.186,1.324-0.384,2.119c-0.546,0.766-1.3,1.17-2.179,1.17
                                          c-1.195,0-2.584-0.754-4.135-2.242c-2.786,0.58-6.039,1.619-8.667,2.77c-0.821,1.742-1.607,3.145-2.339,4.174
                                          C7.828,28.264,6.961,28.922,6.103,28.922z M8.715,23.891c-2.099,1.178-2.953,2.146-3.015,2.693c-0.01,0.09-0.036,0.326,0.423,0.68
                                          C6.27,27.217,7.124,26.826,8.715,23.891z M21.944,19.549c0.799,0.615,1.507,0.951,2.03,0.951c0.229,0,0.532-0.055,0.835-0.479
                                          c0.146-0.205,0.203-0.336,0.225-0.406c-0.12-0.064-0.474-0.195-1.346-0.195C23.193,19.42,22.604,19.463,21.944,19.549z
                                          M14.77,13.066c-0.703,2.428-1.63,5.051-2.625,7.426c2.051-0.795,4.282-1.49,6.377-1.982C17.196,16.971,15.872,15.047,14.77,13.066z
                                          M14.269,4.735c-0.022,0.003-0.053,0.01-0.095,0.024C14.077,4.792,14,4.844,13.935,4.999c-0.253,0.59-0.053,1.712,0.333,2.918
                                          C14.588,5.839,14.418,4.957,14.269,4.735z"/>
                                    </svg></a>
                            </div>

                            <!-- copyright -->
                            <p class="copyright show-for-large-up">
                                &copy; 2014 Copyright Marco De Nadai. <br />
                                Proudly powered by <i><a href="http://getpelican.com/">Pelican</a></i>, which takes great advantage of <i><a href="http://python.org">Python</a></i>.
                            </p>
                            <!-- /copyright -->

                        </footer>
                        <!-- /footer -->
                    </div>
                    <div class="large-8 columns" style="padding-top:30px">
<article id="content" class="body">
  <header>
    <h1 class="entry-title">Detecting anomalies with Neural newtorks</h1>
 
  </header>
  <!-- post details -->
    <span class="date text-right">Sun 07 September 2014</span>
  <!-- /post details -->
  
  <div class="entry-content">
    <p>In this article I will show part of the work I've done during my Master's internship in Amsterdam. The focus of this work was finding outliers in the gas consumption of some buildings. </p>
<p>Energy consumption in buildings is one of the fastest growing sectors. Approximately <strong>41% of the total energy</strong> in Europe is consumed by buildings (households and services). It is showed that <strong>commercial buildings consume from 15% to 30% more energy than necessary</strong> due to poorly maintained, degraded, and improperly controlled equipment. These anomalies can become easy fixable problems with a reliable fault detection and diagnosis (FDD) system. </p>
<p>An outlier, by definition, is an observation which deviates significantly from other observations so that it creates suspicion that it was created by different dynamics. Despite this general definition, the more appropriate way of defining
outliers is highly application-dependent, because even same scenarios may require different determinations of outliers.</p>
<p>In this paper, outliers are very closed related to the problem of time-series forecasting, since outliers are declared on the basis of deviations from expected (or forecast) value.</p>
<p><img alt="outliers" src="/images/outliers.png" /></p>
<p>The system is composed by 2-phase process where in the first one the short-term (hourly) gas consumption is
forecast thanks to a historical time-series, and in the second phase outliers are detected on the basis of deviations from expected (or forecast) value.</p>
<h2>iPython Notebooks</h2>
<p>In these notebooks the dataset is analysed, then it is used by an Artificial Neural Network built in <a href="https://github.com/lisa-lab/pylearn2">pylearn2</a>. This project uses Python with <a href="http://pandas.pydata.org/">pandas</a>.</p>
<ul>
<li><a href="http://nbviewer.ipython.org/github/denadai2/energyUva/blob/master/notebooks/0-Data%2BWeather%2BHolidays.ipynb">Dataset preparation</a></li>
<li><a href="http://nbviewer.ipython.org/github/denadai2/energyUva/blob/master/notebooks/1-Dataset_cleaning.ipynb">Dataset cleaning</a></li>
<li><a href="http://nbviewer.ipython.org/github/denadai2/energyUva/blob/master/notebooks/2-Dataset%20analysis.ipynb">Dataset analysis</a></li>
<li><a href="http://nbviewer.ipython.org/github/denadai2/energyUva/blob/master/notebooks/3-Feature%20engineering.ipynb">Feature engineering</a>. <a href="http://nbviewer.ipython.org/github/denadai2/energyUva/blob/master/notebooks/3bis-%20Regression%20short%20version.ipynb">Short version</a></li>
<li><a href="https://github.com/denadai2/energyUva/blob/master/NN_static_MLSE.yaml">pylearn2 YAML file</a></li>
</ul>
<h2>Results</h2>
<p>This model was able to detect some synthetic and real outliers from the dataset.  Since the predictor is very accurate (with RMSE from 8 m^3 in building 740-NTH, to RMSE 2.5 m^3 in building 761-KMH), the outlier mechanism is able to easily detect strange behaviours defining a threshold value in the confidence interval without the need to possess previous examples of outliers. The scope of this paper was forecasting the highly irregular gas consumption time-series, but it is believed that similar results could be also obtained with electric consumption time-series. It is hoped that this could lead to new analysis of the energy consumption in public buildings.</p>
<p>The draft of the <strong>paper</strong> can be found <a href="https://github.com/denadai2/energyUva/blob/master/paperEnergy/paperv2_2.pdf">here</a>, while the sources are in this <a href="https://github.com/denadai2/energyUva">github project</a>.</p>
<p><strong>The paper is still a draft, so I would really like to listen your opinion, notes, doubts. Please, drop a note here!</strong></p>
  </div><!-- /.entry-content -->
</article>

<section>
    <p id="post-share-links">
        <strong style="text-transform:uppercase;margin-bottom:5px;display:block">Do you like this article?:</strong>
        <a href="http://twitter.com/home?status=Detecting%20anomalies%20with%20Neural%20newtorks%20 http%3A//www.marcodena.it/blog/detecting-anomalies-with-neural-newtorks/" target="_blank" title="Share on Twitter">
          <i class="icon-twitter"></i></a>
        
        <a href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=http%3A//www.marcodena.it/blog/detecting-anomalies-with-neural-newtorks/&p[images][0]=&p[title]=Detecting%20anomalies%20with%20Neural%20newtorks%20&p[summary]=%3Cp%3EIn%20this%20article%20I%20will%20show%20part%20of%20the%20work%20I%27ve%20done%20during%20my%20Master%27s%20internship%20in%20Amsterdam.%20The%20focus%20of%20this%20work%20was%20finding%20outliers%20in%20the%20gas%20consumption%20of%20some%20buildings.%20%3C/p%3E%0A%3Cp%3EEnergy%20consumption%20in%20buildings%20is%20one%20of%20the%20fastest%20growing%20sectors.%20Approximately%20%3Cstrong%3E41%25%20of%20the%20...%3C/strong%3E%3C/p%3E" target="_blank" title="Share on Facebook">
          <i class="icon-facebook"></i></a>
        
        <a href="mailto:?subject=Detecting%20anomalies%20with%20Neural%20newtorks%20&body=http%3A//www.marcodena.it/blog/detecting-anomalies-with-neural-newtorks/" target="_blank" title="Share via Email">
          <i class="icon-mail-alt"></i></a>
    </p>
</section>


<hr id="comment-sep" />
<section class="comments" id="comments">
<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'marcodenait'; // required: replace example with your forum shortname
var disqus_identifier = 'detecting-anomalies-with-neural-newtorks';
var disqus_url = 'http://www.marcodena.it/blog/detecting-anomalies-with-neural-newtorks/';
var disqus_config = function () {
this.language = "en";
};
/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
var dsq = document.createElement('script');
dsq.type = 'text/javascript';
dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


                    </div>
</div>

</div>
</div>

        
        <script type="text/javascript">

            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-210377-21']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();

        </script>
</body>
</html>